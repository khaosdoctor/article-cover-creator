# Cover generator

> Simple utility for generating cover images for my [blog posts](https://blog.lsantos.dev)

## Usage

Clone the repository and run the following command:

```bash
$ deno cache --lock=deno.lock ./src/**/*.ts
```

Then, you can run `deno task start` to start the server.

## How it works

The inner workings of the project are pretty simple. In general, this app is just a web server with a single URL that receives search parameters that follow the format described in [this file](./src/routes/blog/articles/validation.ts); this route responds with a png image. You can use the cover URLs as direct sources to `<img>` tags, which I wanted to do in the first place.

Internally, when a request is made to the server, it validates the parameters sent and spins up a puppeteer page, which is used to render the image. Then a screenshot of that page is taken and returned as a response. There's also a caching mechanism to avoid rendering the same image twice.

## Customizing

This project is not fully customizable yet; the roadmap would allow it to have more templates so you can choose which one you want to use. However, changing the default one is pretty easy; you need to change the `src/templates/article.ejs` file. However, there are some things you need to keep in mind when creating a template:

- Since puppeteer is spun on a headless process and the content is generated by parsing an EJS template on the fly, there's no external requests made, so you cannot use local fonts or images. You can use any other external URLs, though. See [this file](./src/templates/article.ejs) for an example.
- Another option, which is a bit faster since you don't need to make external requests, is to have everything inline, like in [this file](./src/templates/article-inline.ejs). This removes all the needs for external requests, but it's a bit more verbose.
- For now, the validation part is hardcoded, which means it doesn't accept any other parameters. If you want to add more parameters, you need to change the [validation file](./src/routes/blog/articles/validation.ts) and the [template file](./src/templates/article.ejs) to accept it.
- The image is generated with a fixed size of 1440x732px as this is the default value for the images in my blog, so if you want to change it, you need to change both the template and [the image generation file](./src/controllers/createImageFromHtml.ts) because this is the viewport size used to take the screnshot.

Remember that, in the end, it's just HTML so you can generate the file however you want.
